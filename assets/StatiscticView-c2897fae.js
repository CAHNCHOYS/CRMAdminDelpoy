import{d as g,r as S,a8 as M,T as W,a9 as J,X as Q,aa as z,ab as T,ac as Z,ad as q,ae as Y,af as tt,ag as et,ah as st,ai as C,o as d,P as f,f as r,j as c,c as D,g as m,_ as k,aj as at,Z as ot,ak as rt,al as nt,U as P,e as o,B as A,s as v,C as i,a3 as j,G as E,t as V}from"./index-b08fb9b5.js";import"./index-e5e39be6.js";const K={data:{type:Object,required:!0},options:{type:Object,default:()=>({})},plugins:{type:Array,default:()=>[]},datasetIdKey:{type:String,default:"label"},updateMode:{type:String,default:void 0}},lt={type:{type:String,required:!0},...K},ct=st[0]==="2"?(e,t)=>Object.assign(e,{attrs:t}):(e,t)=>Object.assign(e,t);function B(e){return Z(e)?z(e):e}function dt(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;return Z(t)?new Proxy(e,{}):e}function ut(e,t){const a=e.options;a&&t&&Object.assign(a,t)}function N(e,t){e.labels=t}function G(e,t,a){const l=[];e.datasets=t.map(s=>{const n=e.datasets.find(u=>u[a]===s[a]);return!n||!s.data||l.includes(n)?{...s}:(l.push(n),Object.assign(n,s),n)})}function it(e,t){const a={labels:[],datasets:[]};return N(a,e.labels),G(a,e.datasets,t),a}const pt=g({props:lt,setup(e,t){let{expose:a}=t;const l=S(null),s=M(null);a({chart:s});const n=()=>{if(!l.value)return;const{type:_,data:y,options:h,plugins:x,datasetIdKey:I}=e,O=it(y,I),b=dt(O,y);s.value=new q(l.value,{type:_,data:b,options:{...h},plugins:x})},u=()=>{const _=z(s.value);_&&(_.destroy(),s.value=null)},p=_=>{_.update(e.updateMode)};return W(n),J(u),Q([()=>e.options,()=>e.data],(_,y)=>{let[h,x]=_,[I,O]=y;const b=z(s.value);if(!b)return;let F=!1;if(h){const w=B(h),$=B(I);w&&w!==$&&(ut(b,w),F=!0)}if(x){const w=B(x.labels),$=B(O.labels),R=B(x.datasets),H=B(O.datasets);w!==$&&(N(b.config.data,w),F=!0),R&&R!==H&&(G(b.config.data,R,e.datasetIdKey),F=!0)}F&&p(b)},{deep:!0}),()=>T("canvas",{ref:l})}});function U(e,t){return q.register(t),g({props:K,setup(a,l){let{expose:s}=l;const n=M(null),u=p=>{n.value=p==null?void 0:p.chart};return s({chart:n}),()=>T(pt,ct({ref:u},{type:e,...a}))}})}const L=U("bar",Y),X=U("doughnut",tt),_t=U("line",et),ft={key:1,class:"text-h6"},mt=g({__name:"ProductsCount",props:{products:null},setup(e){const t=e,a=C(()=>({labels:t.products.map(s=>s.name),datasets:[{label:"Кол-во: ",backgroundColor:["#512DA8","#283593","#0277BD","#558B2F","#78909C","#BDBDBD","#FF9800","#FBC02D","#42A5F5","#8BC34A","#5D4037","#64FFDA","#EC407A","#004D40","#AFB42B","#AD1457","#9E9E9E"],data:t.products.map(s=>s.count),hoverOffset:4}]})),l={responsive:!0,maintainAspectRatio:!1,layout:{padding:0},plugins:{legend:{display:!1},title:{display:!0,color:"black",text:"Количество каждого товара",padding:{bottom:20},font:{size:26,weight:"normal"}}}};return(s,n)=>(d(),f(m,{"max-width":"100%",elevation:"5",class:"pa-5"},{default:r(()=>[t.products.length?(d(),f(c(X),{key:0,data:c(a),options:l},null,8,["data"])):(d(),D("p",ft,"Недостаточно данных для построения графика"))]),_:1}))}});const gt=k(mt,[["__scopeId","data-v-9551457b"]]),ht={key:1,class:"text-h6"},yt=g({__name:"ProductsPrices",props:{products:null},setup(e){const t=e,a=C(()=>({labels:t.products.map(s=>s.name),datasets:[{label:"Цена(руб): ",backgroundColor:["#512DA8","#283593","#0277BD","#558B2F","#78909C","#BDBDBD","#FF9800","#FBC02D","#42A5F5","#8BC34A","#5D4037","#64FFDA","#EC407A","#004D40","#AFB42B","#AD1457","#9E9E9E"],data:t.products.map(s=>s.price),hoverOffset:4}]})),l={responsive:!0,maintainAspectRatio:!1,layout:{padding:0},plugins:{legend:{display:!1},title:{display:!0,color:"black",text:"Цены товаров",padding:{bottom:20},font:{size:26,weight:"normal"}},tooltip:{}}};return(s,n)=>(d(),f(m,{"max-width":"100%",elevation:"5",class:"pa-5"},{default:r(()=>[t.products.length?(d(),f(c(X),{key:0,data:c(a),options:l},null,8,["data"])):(d(),D("p",ht,"Недостаточно данных для построения графика"))]),_:1}))}});const xt=k(yt,[["__scopeId","data-v-04e52979"]]),bt={key:1,class:"text-h6"},vt=g({__name:"CustomersPremium",props:{customers:null},setup(e){const t=e,a=C(()=>({labels:["Наличие премиума"],datasets:[{label:"Есть премиум",data:[t.customers.filter(s=>s.premium==="Да").length]},{label:"Нету премиума",data:[t.customers.filter(s=>s.premium==="Нет").length]}]})),l={responsive:!0,maintainAspectRatio:!1,layout:{padding:0},elements:{bar:{borderRadius:0,borderWidth:4}},scales:{y:{beginAtZero:!0,suggestedMin:0}},plugins:{legend:{display:!0,position:"bottom",title:{}},title:{display:!0,color:"black",text:"Премиум у клиентов",padding:{bottom:20},font:{size:26,weight:"normal"}}}};return(s,n)=>(d(),f(m,{"max-width":"100%",class:"pa-5",elevation:"5"},{default:r(()=>[t.customers.length?(d(),f(c(L),{key:0,data:c(a),options:l},null,8,["data"])):(d(),D("p",bt,"Недостаточно данных для построения графика"))]),_:1}))}});const Ct=k(vt,[["__scopeId","data-v-377b486c"]]),Dt={key:1,class:"text-h6"},wt=g({__name:"CategoryProductsCount",props:{categories:null,products:null},setup(e){const t=e,a=C(()=>({labels:["Количество товара по категориям"],datasets:t.categories.map(s=>({label:s.name,data:[t.products.filter(n=>n.category===s.name).length]}))})),l={responsive:!0,maintainAspectRatio:!1,layout:{padding:0},elements:{bar:{borderRadius:0,borderWidth:4}},scales:{x:{grid:{display:!1}},y:{grid:{display:!1}}},plugins:{legend:{display:!0,position:"bottom"},title:{display:!0,color:"black",text:"Количество товаров по категориям",padding:{bottom:20},font:{size:26,weight:"normal"}}}};return(s,n)=>(d(),f(m,{"max-width":"100%",class:"pa-5",elevation:"5"},{default:r(()=>[t.products.length?(d(),f(c(L),{key:0,data:c(a),options:l},null,8,["data"])):(d(),D("p",Dt,"Недостаточно данных для построения графика"))]),_:1}))}});const Pt=k(wt,[["__scopeId","data-v-07495283"]]),Bt={key:1,class:"text-h6"},kt=g({__name:"OrdersByDate",props:{orders:null},setup(e){const t=e;function a(u){return u.split("-").reverse().join("-")}const l=C(()=>{const u=[],p=[];for(const _ of t.orders)if(!u.includes(_.date)){const y=t.orders.filter(h=>h.date===_.date);u.push(_.date),p.push(y.reduce((h,x)=>h+x.productCount,0))}return p}),s=C(()=>({labels:[...new Set(t.orders.sort((u,p)=>Date.parse(a(u.date))-Date.parse(a(p.date))).map(u=>u.date))],datasets:[{label:"Кол-во товаров",data:l.value,borderColor:"#3F51B5",fill:!1,borderWidth:4}]})),n={responsive:!0,maintainAspectRatio:!1,layout:{padding:0},scales:{y:{beginAtZero:!1,suggestedMin:0,grid:{display:!1}},x:{grid:{display:!1}}},plugins:{legend:{display:!1},title:{display:!0,color:"black",text:"Кол-во товаров в заказах",padding:{bottom:20},font:{size:26,weight:"normal"}}}};return(u,p)=>(d(),f(m,{width:"100%",color:"white",class:"pa-5",elevation:"5"},{default:r(()=>[t.orders.length?(d(),f(c(_t),{key:0,data:c(s),options:n},null,8,["data"])):(d(),D("p",Bt,"Недостаточно данных для построения графика"))]),_:1}))}});const At=k(kt,[["__scopeId","data-v-e2cbfbac"]]),Ot={key:1,class:"text-h6"},Ft=g({__name:"ProductsInOrders",props:{products:null,orders:null},setup(e){const t=e,a=C(()=>({labels:["Товары"],datasets:t.products.map(s=>({label:s.name,data:[t.orders.filter(n=>n.productId===s.id).length]}))})),l={responsive:!0,maintainAspectRatio:!1,scales:{y:{beginAtZero:!0,grid:{display:!1}},x:{grid:{display:!1}}},layout:{padding:0},elements:{bar:{borderWidth:4,borderRadius:0}},plugins:{title:{display:!0,text:"Сколько раз был заказан какой товар",padding:{bottom:20},font:{size:20,weight:"bold"}},legend:{display:!1}}};return(s,n)=>(d(),f(m,{color:"white",class:"pa-5",elevation:"5"},{default:r(()=>[t.orders.length?(d(),f(c(L),{key:0,data:c(a),options:l},null,8,["data"])):(d(),D("p",Ot,"Недостаточно данных для построения графика"))]),_:1}))}});const St=k(Ft,[["__scopeId","data-v-bd750fb1"]]),It=v("h2",{class:"title text-sm-h2 text-h3 mb-6"},"Статистика",-1),$t=v("p",{class:"text-sm-h5 text-h6"},"Всего товаров",-1),Rt={class:"text-h2"},jt=v("p",{class:"text-sm-h5 text-h6"},"Всего Клиентов",-1),Et={class:"text-h2"},Vt=v("p",{class:"text-sm-h5 text-h6"},"Всего Заказов",-1),zt={class:"text-h2"},Mt=g({__name:"StatiscticView",setup(e){const{smAndDown:t}=at(),a=ot(),l=rt(),s=nt(),n=S({count:0}),u=S({count:0}),p=S({count:0});return W(async()=>{a.productsCategories.length||await a.getAllProductsCategories(),P.from(".title",{x:"-300",opacity:0,ease:"linear",duration:.5}),P.from(".stats-header > *",{x:"-100%",stagger:.25,duration:.25,opacity:0,ease:"power2.out"}),P.from(".charts-row > *",{scale:0,stagger:.35,duration:.35,opacity:0,ease:"power3.out",delay:.85,scrollTrigger:{trigger:".charts-row",start:"top 80%",end:"+=1000"}}),P.to(n.value,{count:a.userProducts.length,duration:2.5,delay:.25}),P.to(u.value,{count:l.customers.length,duration:2.5,delay:.5}),P.to(p.value,{count:s.orders.length,duration:2.5,delay:.75})}),(_,y)=>(d(),D("div",null,[It,o(A,{class:"stats-header"},{default:r(()=>[o(i,{sm:"4",cols:"12",class:"left-header-col"},{default:r(()=>[o(m,{color:"green",height:"100%",elevation:"0"},{default:r(()=>[o(j,null,{default:r(()=>[o(A,{align:"center","no-gutters":c(t)},{default:r(()=>[o(i,{md:"auto",cols:"12",class:"d-md-block d-flex justify-center mb-md-0 mb-1"},{default:r(()=>[o(E,{icon:"mdi-laptop",color:"blue-grey",class:"text-white"})]),_:1}),o(i,{cols:"auto",class:"flex-grow-1 text-md-left text-center"},{default:r(()=>[$t,v("p",Rt,V(n.value.count.toFixed(0)),1)]),_:1})]),_:1},8,["no-gutters"])]),_:1})]),_:1})]),_:1}),o(i,{sm:"4",cols:"6",class:"right-header-col"},{default:r(()=>[o(m,{color:"deep-orange-lighten-2",height:"100%",elevation:"0"},{default:r(()=>[o(j,null,{default:r(()=>[o(A,{align:"center","no-gutters":c(t)},{default:r(()=>[o(i,{md:"auto",cols:"12",class:"d-md-block d-flex justify-center mb-md-0 mb-1"},{default:r(()=>[o(E,{icon:"mdi-account",color:"cyan",class:"text-white"})]),_:1}),o(i,{cols:"auto",class:"flex-grow-1 text-white text-md-left text-center"},{default:r(()=>[jt,v("p",Et,V(u.value.count.toFixed(0)),1)]),_:1})]),_:1},8,["no-gutters"])]),_:1})]),_:1})]),_:1}),o(i,{sm:"4",cols:"6",class:"right-header-col"},{default:r(()=>[o(m,{color:"light-blue",height:"100%",elevation:"0"},{default:r(()=>[o(j,null,{default:r(()=>[o(A,{align:"center","no-gutters":c(t)},{default:r(()=>[o(i,{md:"auto",cols:"12",class:"d-md-block d-flex justify-center mb-md-0 mb-1"},{default:r(()=>[o(E,{icon:"mdi-wallet",color:"pink",class:"text-white"})]),_:1}),o(i,{cols:"auto",class:"flex-grow-1 text-white text-md-left text-center"},{default:r(()=>[Vt,v("p",zt,V(p.value.count.toFixed(0)),1)]),_:1})]),_:1},8,["no-gutters"])]),_:1})]),_:1})]),_:1})]),_:1}),o(A,{align:"stretch",class:"charts-row"},{default:r(()=>[o(i,{md:"4",sm:"6",cols:"12"},{default:r(()=>[o(gt,{products:c(a).userProducts},null,8,["products"])]),_:1}),o(i,{md:"4",sm:"6",cols:"12"},{default:r(()=>[o(xt,{products:c(a).userProducts},null,8,["products"])]),_:1}),o(i,{md:"4",sm:"6",cols:"12"},{default:r(()=>[o(Ct,{customers:c(l).customers},null,8,["customers"])]),_:1}),o(i,{md:"4",sm:"6",cols:"12"},{default:r(()=>[o(Pt,{products:c(a).userProducts,categories:c(a).productsCategories},null,8,["products","categories"])]),_:1}),o(i,{md:"8",cols:"12"},{default:r(()=>[o(At,{orders:c(s).orders},null,8,["orders"])]),_:1}),o(i,{cols:"12"},{default:r(()=>[o(St,{products:c(a).userProducts,orders:c(s).orders},null,8,["products","orders"])]),_:1})]),_:1})]))}});export{Mt as default};
