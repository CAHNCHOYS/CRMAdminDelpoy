System.register(["./index-legacy-9bb8cf7f.js","./alert-legacy-1f2322f2.js","./useFormSchemas-legacy-1f7ae4a9.js"],(function(e,a){"use strict";var t,l,s,r,o,i,n,d,c,u,m,g,p,f,h,b,x,v,y,w,_,k,S,V,M,z,T,q,F,U,j,C,E,A,B,D,I,L,O,$,G,H=document.createElement("style");return H.textContent='.fullscreen[data-v-643b41f6]{position:relative;padding:20px 15px}.form-card[data-v-643b41f6]{position:relative;z-index:4}.bg-image[data-v-643b41f6]{position:absolute;width:100%;height:100%;top:0;left:0;z-index:2}.bg-image[data-v-643b41f6]:before{content:"";position:absolute;z-index:3;width:100%;height:100%;top:0;left:0;background-color:rgba(196,196,196,.3)}.form-title[data-v-643b41f6]{background-color:#c6d9ee;font-weight:600;color:#0f1e54}.alert[data-v-643b41f6]{position:fixed;z-index:1000;left:10px;top:15px;width:calc(100% - 20px)!important;height:auto}.icon[data-v-643b41f6]{opacity:1!important;color:#0f1e54}\n',document.head.appendChild(H),{setters:[e=>{t=e.d,l=e.r,s=e.u,r=e.A,o=e.a,i=e.i,n=e.h,d=e.w,c=e.c,u=e.b,m=e.e,g=e.V,p=e.f,f=e.g,h=e.j,b=e.k,x=e.l,v=e.o,y=e.m,w=e.n,_=e.p,k=e.t,S=e.q,V=e.s,M=e.v,z=e.x,T=e.y,q=e.z,F=e.B,U=e.C,j=e.D,C=e.E,E=e.F,A=e.G,B=e.H,D=e.I,I=e._},e=>{L=e.u},e=>{O=e.u,$=e.a,G=e.b}],execute:function(){const H=""+new URL("bg-ffc91902.png",a.meta.url).href,P=e=>(B("data-v-643b41f6"),e=e(),D(),e),R={class:"fullscreen h-100 d-flex justify-center align-center"},J={class:"text-white text-h6"},K=P((()=>S("span",{class:"text-white text-h6 font-weight-medium"},"Войти",-1))),N={class:"mt-2"},Q=P((()=>S("span",{class:"text-decoration-underline text-green"}," Зарегистрироваться ",-1)));e("default",I(t({__name:"LoginView",setup(e){const{loginSchema:a}=O(),{handleSubmit:t,isSubmitting:B,resetForm:D}=$({validationSchema:a}),{value:I,errorMessage:P}=G("email"),{value:W,errorMessage:X}=G("password"),Y=l(!1),Z=s(),ee=L(),ae=b(),te=x(),le=t((async e=>{try{const{data:a}=await r.login(e);Z.setToken(a.accessToken),Z.setUser(a.user),await Z.fetchData(),o.defaults.headers.common.Authorization=`Bearer ${a.accessToken}`,ee.showMessage("success","Авторизация успешна, вскоре вы будете переведены на сайт"),setTimeout((()=>{ae.query.redirectedFrom?te.push({name:ae.query.redirectedFrom}):te.push("/")}),3500)}catch(a){console.log(a),i(a)?ee.showMessage("error",n(a)):ee.showMessage("error","Ошибка при авторизации, попробуйте позже")}finally{D()}}));return d((()=>{ae.query.redirectedFrom&&!ae.query.isExpiredToken&&ee.showMessage("error",`Для доступа к странице ${ae.query.redirectedFrom} необходимо авторизироваться`),ae.query.isExpiredToken&&(ee.showMessage("error","Сеанс авторизации истек, войдите в аккаунт снова!"),Z.logOutUser())})),(e,a)=>{const t=A("router-link");return v(),c("div",R,[u(g,null,{default:m((()=>[u(y,{class:"alert",type:f(ee).messageType,"max-width":400,modelValue:f(ee).isMessageShown,"onUpdate:modelValue":a[0]||(a[0]=e=>f(ee).isMessageShown=e)},{default:m((()=>[u(w,{class:"text-h4 mb-2"},{default:m((()=>[_(k("error"===f(ee).messageType?"Ошибка":"Уведомление"),1)])),_:1}),S("div",J,k(f(ee).messageText),1)])),_:1},8,["type","modelValue"])])),_:1}),u(p,{class:"form-card flex-grow-1 pb-8 rounded-lg","max-width":486,elevation:0},{default:m((()=>[u(V,{class:"form-title text-center text-h4 pa-0 py-4"},{default:m((()=>[_("Авторизация")])),_:1}),u(M,{class:"pt-4 pb-1 px-lg-10 px-md-8 px-4"},{default:m((()=>[u(z,{onSubmit:T(f(le),["prevent"]),class:"w-100"},{default:m((()=>[u(V,{class:"text-indigo-darken-2 text-center mb-2"},{default:m((()=>[_(" Введите ваши данные")])),_:1}),u(q,null,{default:m((()=>[u(F,{cols:"12"},{default:m((()=>[u(U,{modelValue:f(I),"onUpdate:modelValue":a[1]||(a[1]=e=>j(I)?I.value=e:null),"error-messages":f(P),"bg-color":"rgba(229, 229, 229, 0.25)",placeholder:"Ваша почта",hint:"Ваша почта при регистрации",clearable:""},{"prepend-inner":m((()=>[u(C,{icon:"mdi-email",class:"icon mr-lg-3 mr-1",size:"large"})])),_:1},8,["modelValue","error-messages","bg-color"])])),_:1}),u(F,{cols:"12"},{default:m((()=>[u(U,{modelValue:f(W),"onUpdate:modelValue":a[3]||(a[3]=e=>j(W)?W.value=e:null),"error-messages":f(X),"bg-color":"rgba(229, 229, 229, 0.25)",placeholder:"Ваш пароль",hint:"Ваш пароль при регистрации",type:Y.value?"text":"password",clearable:""},{"prepend-inner":m((()=>[u(C,{icon:"mdi-lock",class:"icon mr-lg-3 mr-1",size:"large"})])),"append-inner":m((()=>[u(C,{onClick:a[2]||(a[2]=e=>Y.value=!Y.value),class:"text-dark-blue",icon:Y.value?"mdi-eye":"mdi-eye-off",size:"large"},null,8,["icon"])])),_:1},8,["modelValue","error-messages","bg-color","type"])])),_:1}),u(F,null,{default:m((()=>[u(E,{type:"submit",loading:f(B),disabled:f(B)||f(ee).isMessageShown,block:"",color:"dark-blue",variant:"flat"},{default:m((()=>[K])),_:1},8,["loading","disabled"]),S("p",N,[u(t,{to:{name:"register-page"},class:"text-black text-h6"},{default:m((()=>[_("Нет аккаунта? "),Q])),_:1})])])),_:1})])),_:1})])),_:1},8,["onSubmit"])])),_:1})])),_:1}),u(h,{class:"bg-image",cover:"",src:f(H),alt:"OfficePic"},null,8,["src"])])}}}),[["__scopeId","data-v-643b41f6"]]))}}}));
