System.register(["./index-legacy-67bac1ad.js"],(function(e,t){"use strict";var a,l,o,r,n,s,i,d,u,c,g,m,p,v,h,y,f,w,_,x,b,N,k,V,T,D,C,U,F,M,A,S,$,z,H,I,L,j,q,E,B,G,P,Q,W,J=document.createElement("style");return J.textContent=".note[data-v-44834e74]{cursor:move}.dragging{opacity:.5!important}.white-input .v-messages__message{color:#fff!important}\n",document.head.appendChild(J),{setters:[e=>{a=e.d,l=e.r,o=e.o,r=e.c,n=e.s,s=e.am,i=e.an,d=e.t,u=e.e,c=e.D,g=e.f,m=e.F,p=e.ao,v=e.ap,h=e._,y=e.b,f=e.a,w=e.u,_=e.Q,x=e.T,b=e.i,N=e.h,k=e.j,V=e.W,T=e.P,D=e.B,C=e.N,U=e.n,F=e.$,M=e.a1,A=e.aq,S=e.ar,$=e.C,z=e.z,H=e.v,I=e.q,L=e.as,j=e.p,q=e.x,E=e.a4,B=e.y,G=e.G,P=e.g,Q=e.a3,W=e.U}],execute:function(){const t={class:"d-flex align-center"},J={class:"flex-grow-1"},K=h(a({__name:"Note",props:{note:null},emits:["deleteNote","dragstart","dragend","updateNote"],setup(e,{emit:a}){const h=e,y=l(!1),f=()=>{a("updateNote",h.note),y.value=!1};return(a,l)=>(o(),r("div",{class:"note py-3 px-4 bg-white mb-3",onDragstart:l[3]||(l[3]=t=>a.$emit("dragstart",t,e.note.id)),onDragend:l[4]||(l[4]=e=>a.$emit("dragend",e))},[n("div",t,[s(n("div",{class:"text-h6 flex-grow-1 pr-1"},d(e.note.title),513),[[i,!y.value]]),s(n("div",J,[u(c,{modelValue:e.note.title,"onUpdate:modelValue":l[0]||(l[0]=t=>e.note.title=t),density:"comfortable",variant:"underlined",clearable:!1,"bg-color":"white"},null,8,["modelValue"])],512),[[i,y.value]]),n("div",null,[u(v,null,{default:g((({props:t,isHovering:o})=>[u(m,p({icon:"mdi-trash-can",size:"large",color:o?"red-darken-3":"grey",onClick:l[1]||(l[1]=t=>a.$emit("deleteNote",e.note.id))},t),null,16,["color"])])),_:1}),u(v,null,{default:g((({props:e,isHovering:t})=>[s(u(m,p({onClick:l[2]||(l[2]=e=>y.value=!y.value),icon:"mdi-pencil",size:"large",color:t?"blue":"grey"},e),null,16,["color"]),[[i,!y.value]])])),_:1}),u(v,null,{default:g((({props:e,isHovering:t})=>[s(u(m,p({onClick:f,style:{cursor:"pointer"},icon:"mdi-content-save-all",size:"large",color:t?"green":"grey"},e),null,16,["color"]),[[i,y.value]])])),_:1})])])],32))}}),[["__scopeId","data-v-44834e74"]]),O=new class{async getNotes(e){return y.get(`/Notes/${e}`)}async updateNote(e){return await y.patch("/Notes",e)}async deleteNote(e){return await y.delete(`/Notes/${e}`)}async addNote(e){return await y.post("/Notes",e)}},R={class:"text-h6"},X=n("div",{class:"text-h2 mb-8 title"},"Ваши заметки",-1),Y={key:0,class:""},Z=n("p",{class:"mb-3 text-h6"},"Загрузка заметок ...",-1),ee={key:0,color:"transparent","max-height":700,style:{overflow:"auto","max-height":"700px"}},te=["onClick"],ae=n("p",{class:"mb-2"},"Загрузка...",-1);e("default",a({__name:"NotesView",setup(e){const t=l([{title:"В процессе",isFormActive:!1,addText:""},{title:"Сделать потом",isFormActive:!1,addText:""},{title:"Сделано",isFormActive:!1,addText:""}]),a=(e,t)=>{e.target.classList.add("dragging"),e.dataTransfer.setData("id",t.toString())},p=e=>{e.target.classList.remove("dragging")},v=f(),h=w(),y=l([]),J=l(!1),le=l(!1),oe=l(null),re=_((()=>function(e){return y.value.filter((t=>t.type===e))}));x((async()=>{le.value=!0;try{const{data:e}=await O.getNotes(h.currentUser.id);y.value=e.notes}catch(e){b(e)?oe.value=N(e):oe.value="Ошибка при загрузке заметок!"}le.value=!1}));const ne=async e=>{J.value=!0;try{await O.updateNote(e)}catch(t){b(t)?v.showMessage("error",N(t)):v.showMessage("error","Ошибка при добавлении заметки!")}J.value=!1},se=async e=>{J.value=!0;try{await O.deleteNote(e),y.value=y.value.filter((t=>t.id!=e))}catch(t){b(t)?v.showMessage("error",N(t)):v.showMessage("error","Ошибка при добавлении заметки!")}J.value=!1},ie=(e,t)=>{W.from(e,{opacity:0,scale:0,ease:"sine.out",duration:.6,onComplete:t})},de=(e,t)=>{W.to(e,{duration:.6,ease:"sine.out",opacity:0,scale:0,onComplete:t})};return(e,l)=>(o(),r("div",null,[u(V,{modelValue:k(v).isMessageShown,"onUpdate:modelValue":l[0]||(l[0]=e=>k(v).isMessageShown=e),color:k(v).messageType},{default:g((()=>[n("p",R,d(k(v).messageText),1)])),_:1},8,["modelValue","color"]),X,le.value?(o(),r("div",Y,[Z,u(M,{color:"green",height:"4",indeterminate:""})])):oe.value?C("",!0):(o(),T(D,{key:1,class:"row"},{default:g((()=>[(o(!0),r(A,null,S(t.value,(e=>(o(),T($,{key:e.title,onDragover:l[1]||(l[1]=z((()=>{}),["prevent"])),onDrop:t=>(async(e,t)=>{const a=e.dataTransfer?.getData("id");if(a){const e=y.value.find((e=>e.id===+a));e.type=t,await ne(e)}})(t,e.title)},{default:g((()=>[u(P,{color:"blue-grey-darken-1 pa-4"},{default:g((()=>[u(H,{class:"text-h4 text-white mb-5 pa-0"},{default:g((()=>[I(d(e.title),1)])),_:2},1024),k(re)(e.title).length?(o(),r("div",ee,[u(L,{onEnter:ie,onLeave:de,css:!1,appear:""},{default:g((()=>[(o(!0),r(A,null,S(k(re)(e.title),(e=>(o(),T(K,{key:e.id,note:e,onDeleteNote:se,onUpdateNote:ne,draggable:"true",onDragstart:a,onDragend:p},null,8,["note"])))),128))])),_:2},1024)])):(o(),T(U,{key:1,color:"white",class:"mb-2","border-color":"white"},{default:g((()=>[u(j,null,{default:g((()=>[I("Пока нет заметок, добавьте хоть одну !")])),_:1})])),_:1})),u(q,{class:"d-flex flex-column pa-0 align-stretch",style:{"min-height":"auto"}},{default:g((()=>[n("div",{onClick:t=>e.isFormActive=!e.isFormActive,style:{cursor:"pointer"}},[u(m,{icon:e.isFormActive?"mdi-minus":"mdi-plus"},null,8,["icon"]),I(" Добавить заметку ")],8,te),u(E,null,{default:g((()=>[s(u(B,{onSubmit:z((t=>{(async(e,t)=>{if(!(e.length<1)){J.value=!0;try{const{data:a}=await O.addNote({title:e,type:t,userId:h.currentUser.id});y.value.push({id:a.noteId,title:e,type:t})}catch(a){b(a)?v.showMessage("error",N(a)):v.showMessage("error","Ошибка при добавлении заметки!")}J.value=!1}})(e.addText,e.title),e.addText=""}),["prevent"])},{default:g((()=>[u(c,{"bg-color":"white",color:"black",placeholder:"Задача...",modelValue:e.addText,"onUpdate:modelValue":t=>e.addText=t,class:"my-2 white-input",rules:[e=>!!e||"Поле обязательное для ввода"]},null,8,["modelValue","onUpdate:modelValue","rules"]),u(G,{type:"submit",variant:"flat",color:"green"},{default:g((()=>[I("Добавить")])),_:1})])),_:2},1032,["onSubmit"]),[[i,e.isFormActive]])])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1032,["onDrop"])))),128))])),_:1})),!le.value&&oe.value?(o(),T(U,{key:2,type:"error",border:"end",variant:"tonal"},{default:g((()=>[u(j,{class:"mb-2"},{default:g((()=>[I(" Ошибка при загрузке товаров ")])),_:1}),n("p",null,d(oe.value),1)])),_:1})):C("",!0),u(F,{modelValue:J.value,"onUpdate:modelValue":l[2]||(l[2]=e=>J.value=e),scrim:!1,persistent:"",width:"auto"},{default:g((()=>[u(P,{color:"indigo-darken-4"},{default:g((()=>[u(Q,null,{default:g((()=>[ae,u(M,{indeterminate:"",color:"white",class:"mb-0"})])),_:1})])),_:1})])),_:1},8,["modelValue"])]))}}))}}}));
