System.register(["./index-legacy-8b0be313.js","./alert-legacy-299e871f.js"],(function(e,t){"use strict";var a,o,l,r,n,s,i,d,c,u,v,g,p,m,f,h,y,N,w,x,_,b,k,A,V,T,D,C,U,F,M=document.createElement("style");return M.textContent=".note[data-v-44834e74]{cursor:move}.dragging{opacity:.5!important}.white-input .v-messages__message{color:#fff!important}\n",document.head.appendChild(M),{setters:[e=>{a=e.d,o=e.r,l=e.o,r=e.c,n=e.m,s=e.T,i=e.U,d=e.t,c=e.b,u=e.e,v=e.V,g=e.k,p=e._,m=e.a,f=e.u,h=e.z,y=e.B,N=e.i,w=e.h,x=e.f,_=e.y,b=e.x,k=e.p,A=e.W,V=e.X,T=e.n,D=e.l,C=e.Y,U=e.C},e=>{F=e.u}],execute:function(){const t={class:"d-flex align-center"},M={class:"flex-grow-1"},S=p(a({__name:"Note",props:{note:null},emits:["deleteNote","dragstart","dragend","updateNote"],setup(e,{emit:a}){const p=e,m=o(!1),f=()=>{a("updateNote",p.note),m.value=!1};return(a,o)=>{const p=g("v-text-field"),h=g("v-icon"),y=g("v-hover");return l(),r("div",{class:"note py-3 px-4 bg-white mb-3",onDragstart:o[3]||(o[3]=t=>a.$emit("dragstart",t,e.note.id)),onDragend:o[4]||(o[4]=e=>a.$emit("dragend",e))},[n("div",t,[s(n("div",{class:"text-h6 flex-grow-1 pr-1"},d(e.note.title),513),[[i,!m.value]]),s(n("div",M,[c(p,{modelValue:e.note.title,"onUpdate:modelValue":o[0]||(o[0]=t=>e.note.title=t),density:"comfortable",variant:"underlined",clearable:!1,"bg-color":"white"},null,8,["modelValue"])],512),[[i,m.value]]),n("div",null,[c(y,null,{default:u((({props:t,isHovering:l})=>[c(h,v({icon:"mdi-trash-can",size:"large",color:l?"red-darken-3":"grey",onClick:o[1]||(o[1]=t=>a.$emit("deleteNote",e.note.id))},t),null,16,["color"])])),_:1}),c(y,null,{default:u((({props:e,isHovering:t})=>[s(c(h,v({onClick:o[2]||(o[2]=e=>m.value=!m.value),icon:"mdi-pencil",size:"large",color:t?"blue":"grey"},e),null,16,["color"]),[[i,!m.value]])])),_:1}),c(y,null,{default:u((({props:e,isHovering:t})=>[s(c(h,v({onClick:f,style:{cursor:"pointer"},icon:"mdi-content-save-all",size:"large",color:t?"green":"grey"},e),null,16,["color"]),[[i,m.value]])])),_:1})])])],32)}}}),[["__scopeId","data-v-44834e74"]]),L=new class{async getNotes(e){return m.get(`/Notes/${e}`)}async updateNote(e){return await m.patch("/Notes",e)}async deleteNote(e){return await m.delete(`/Notes/${e}`)}async addNote(e){return await m.post("/Notes",e)}},$={class:"text-h6"},z=n("div",{class:"text-h2 mb-8 title"},"Ваши заметки",-1),E={key:0,class:""},B=n("p",{class:"mb-3 text-h6"},"Загрузка заметок ...",-1),H={key:0,color:"transparent","max-height":700,style:{overflow:"auto","max-height":"700px"}},I=["onClick"],j=n("p",{class:"mb-2"},"Загрузка...",-1);e("default",a({__name:"NotesView",setup(e){const t=F(),{notes:a,filterNotesByType:v,isActionLoading:p,isNotesFetching:m,fetchNotesError:M,addNoteAction:W,updateNoteAction:X,deleteNoteAction:Y}=(()=>{const e=F(),t=f(),a=o([]),l=o(!1),r=o(!1),n=o(null),s=h((()=>function(e){return a.value.filter((t=>t.type===e))}));return y((async()=>{r.value=!0;try{const{data:e}=await L.getNotes(t.currentUser.id);a.value=e.notes}catch(e){N(e)?n.value=w(e):n.value="Ошибка при загрузке заметок!"}r.value=!1})),{deleteNoteAction:async t=>{l.value=!0;try{await L.deleteNote(t),a.value=a.value.filter((e=>e.id!=t))}catch(o){N(o)?e.showMessage("error",w(o)):e.showMessage("error","Ошибка при добавлении заметки!")}l.value=!1},updateNoteAction:async t=>{l.value=!0;try{await L.updateNote(t)}catch(a){N(a)?e.showMessage("error",w(a)):e.showMessage("error","Ошибка при добавлении заметки!")}l.value=!1},addNoteAction:async(o,r)=>{if(!(o.length<1)){l.value=!0;try{const{data:e}=await L.addNote({title:o,type:r,userId:t.currentUser.id});a.value.push({id:e.noteId,title:o,type:r})}catch(n){N(n)?e.showMessage("error",w(n)):e.showMessage("error","Ошибка при добавлении заметки!")}l.value=!1}},isActionLoading:l,isNotesFetching:r,fetchNotesError:n,notes:a,filterNotesByType:s}})(),q=o([{title:"В процессе",isFormActive:!1,addText:""},{title:"Сделать потом",isFormActive:!1,addText:""},{title:"Сделано",isFormActive:!1,addText:""}]),G=(e,t)=>{e.target.classList.add("dragging"),e.dataTransfer.setData("id",t.toString())},J=e=>{e.target.classList.remove("dragging")},K=(e,t)=>{U.from(e,{opacity:0,scale:0,ease:"sine.out",duration:.6,onComplete:t})},O=(e,t)=>{U.to(e,{duration:.6,ease:"sine.out",opacity:0,scale:0,onComplete:t})};return(e,o)=>{const f=g("v-snackbar"),h=g("v-progress-linear"),y=g("v-card-title"),N=g("v-alert-title"),w=g("v-alert"),U=g("v-icon"),F=g("v-text-field"),L=g("v-btn"),P=g("v-form"),Q=g("v-expand-transition"),R=g("v-card-actions"),Z=g("v-card"),ee=g("v-col"),te=g("v-row"),ae=g("v-card-text"),oe=g("v-dialog");return l(),r("div",null,[c(f,{modelValue:x(t).isMessageShown,"onUpdate:modelValue":o[0]||(o[0]=e=>x(t).isMessageShown=e),color:x(t).messageType},{default:u((()=>[n("p",$,d(x(t).messageText),1)])),_:1},8,["modelValue","color"]),z,x(m)?(l(),r("div",E,[B,c(h,{color:"green",height:"4",indeterminate:""})])):(l(),_(te,{key:1,class:"row"},{default:u((()=>[(l(!0),r(A,null,V(q.value,(e=>(l(),_(ee,{key:e.title,onDragover:o[1]||(o[1]=T((()=>{}),["prevent"])),onDrop:t=>(async(e,t)=>{const o=e.dataTransfer?.getData("id");if(o){const e=a.value.find((e=>e.id===+o));e.type=t,await X(e)}})(t,e.title)},{default:u((()=>[c(Z,{color:"blue-grey-darken-1 pa-4"},{default:u((()=>[c(y,{class:"text-h4 text-white mb-5 pa-0"},{default:u((()=>[D(d(e.title),1)])),_:2},1024),x(v)(e.title).length?(l(),r("div",H,[c(C,{onEnter:K,onLeave:O,css:!1,appear:""},{default:u((()=>[(l(!0),r(A,null,V(x(v)(e.title),(e=>(l(),_(S,{key:e.id,note:e,onDeleteNote:x(Y),onUpdateNote:x(X),draggable:"true",onDragstart:G,onDragend:J},null,8,["note","onDeleteNote","onUpdateNote"])))),128))])),_:2},1024)])):(l(),_(w,{key:1,color:"white",class:"mb-2","border-color":"white"},{default:u((()=>[c(N,null,{default:u((()=>[D("Пока нет заметок, добавьте хоть одну !")])),_:1})])),_:1})),c(R,{class:"d-flex flex-column pa-0 align-stretch",style:{"min-height":"auto"}},{default:u((()=>[n("div",{onClick:t=>e.isFormActive=!e.isFormActive,style:{cursor:"pointer"}},[c(U,{icon:e.isFormActive?"mdi-minus":"mdi-plus"},null,8,["icon"]),D(" Добавить заметку ")],8,I),c(Q,null,{default:u((()=>[s(c(P,{onSubmit:T((t=>{x(W)(e.addText,e.title),e.addText=""}),["prevent"])},{default:u((()=>[c(F,{"bg-color":"white",color:"black",placeholder:"Задача...",modelValue:e.addText,"onUpdate:modelValue":t=>e.addText=t,class:"my-2 white-input",rules:[e=>!!e||"Поле обязательное для ввода"]},null,8,["modelValue","onUpdate:modelValue","rules"]),c(L,{type:"submit",variant:"flat",color:"green"},{default:u((()=>[D("Добавить")])),_:1})])),_:2},1032,["onSubmit"]),[[i,e.isFormActive]])])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1032,["onDrop"])))),128))])),_:1})),!x(m)&&x(M)?(l(),_(w,{key:2,type:"error",border:"end",variant:"tonal"},{default:u((()=>[c(N,{class:"mb-2"},{default:u((()=>[D(" Ошибка при загрузке товаров ")])),_:1}),n("p",null,d(x(M)),1)])),_:1})):b("",!0),c(oe,{modelValue:x(p),"onUpdate:modelValue":o[2]||(o[2]=e=>k(p)?p.value=e:null),scrim:!1,persistent:"",width:"auto"},{default:u((()=>[c(Z,{color:"indigo-darken-4"},{default:u((()=>[c(ae,null,{default:u((()=>[j,c(h,{indeterminate:"",color:"white",class:"mb-0"})])),_:1})])),_:1})])),_:1},8,["modelValue"])])}}}))}}}));
