import{r as v,P as D,W as E,d as F,ai as q,o as d,O as B,e as h,q as n,c as f,aq as y,b as m,an as k,p as L,t as g,al as $,am as _,E as I,av as U,ao as M,ap as S,K as O,aw as C,F as T,ar as W,ax as j,T as z,u as G,l as H}from"./index-619baa70.js";const oe=({tableElements:t,sortField:l,pageName:i,route:s,router:r})=>{const a=v(+s.query.currentPage||1),e=v(10),o=D(()=>Math.ceil(t.value.length/e.value)),c=v(!1),N=u=>{l.value===u?c.value=!c.value:c.value=!1,l.value=u},P=u=>{a.value=u},V=D(()=>{const u=t.value.length;let p=(a.value-1)*e.value;p>=u&&u&&(P(Math.ceil(u/e.value)),p=(a.value-1)*e.value);let A=p+e.value;const w=t.value.slice(p,A);return c.value?w.sort((x,b)=>x[l.value]>b[l.value]?-1:1):w.sort((x,b)=>x[l.value]>b[l.value]?1:-1)});return E(a,()=>{r.push({name:i,query:{...s.query,currentPage:a.value}})}),{currentPage:a,paginatedElements:V,totalPages:o,isInverseSort:c,elementsPerPageCount:e,setSortField:N}},se=()=>{const t=v(!1),l=v(!1),i=v(!1),s=v(null);return{isAddDialogActive:t,isEditDialogActive:i,isDeleteDialogActive:l,itemToEdit:s,openDialog:(a,e)=>{s.value=a,e==="edit"&&(i.value=!0),e==="delete"&&(l.value=!0)}}},K={class:"d-sm-table-row d-none"},R=["onClick"],J=n("th",{class:"text-h6 pa-0 pr-3 pb-3 font-weight-bold text-black text-left"},"Действия",-1),Q={class:"d-sm-none d-table-row"},X=["colspan"],Y={class:"d-sm-none d-block font-weight-bold flex-grow-1 pr-1"},Z={class:"text-sm-left text-right"},ee={class:"d-sm-table-cell d-flex justify-end h-auto pa-0 py-3"},te={class:"d-flex flex-wrap"},ae={key:1,class:"text-center text-h6 text-error font-weight-bold mb-5"},ne=F({__name:"ElementsTable",props:{items:null,fields:null,currentSortField:null,isInverseSort:{type:Boolean},noDataText:null},emits:["updateSortField","openDialog"],setup(t,{emit:l}){const{xs:i}=q(),s=(r,a)=>{i.value||z.from(r,{duration:.6,opacity:0,y:"-50%",ease:"power1.out",onComplete:a})};return(r,a)=>t.items.length?(d(),B(j,{key:0},{default:h(()=>[n("tr",K,[(d(!0),f(S,null,y(t.fields,e=>(d(),f("th",{class:"text-h6 pa-0 pb-3 font-weight-bold text-black text-left",key:e.fieldName,onClick:o=>r.$emit("updateSortField",e.fieldName)},[m(M,null,{default:h(({isHovering:o,props:c})=>[n("p",k(c,{class:"pr-6 d-inline-block",style:{position:"relative"}}),[L(g(e.fieldText)+" ",1),$(m(I,{style:U([{position:"absolute",right:"0px",top:"50%",transform:"translate(0, -50%)"},{opacity:o&&t.currentSortField!=e.fieldName?.6:1}]),icon:t.isInverseSort&&t.currentSortField==e.fieldName?"mdi-arrow-up-thin":"mdi-arrow-down-thin"},null,8,["icon","style"]),[[_,t.currentSortField===e.fieldName||o]])],16)]),_:2},1024)],8,R))),128)),J]),n("tr",Q,[n("td",{colspan:t.fields.length+1},[m(O,{items:t.fields,"item-title":"fieldText","item-value":"fieldName","model-value":t.currentSortField,"onUpdate:modelValue":a[0]||(a[0]=e=>l("updateSortField",e)),variant:"underlined",clearable:!1,label:"Сортировать по"},null,8,["items","model-value"])],8,X)]),n("tbody",null,[m(W,{onEnter:s},{default:h(()=>[(d(!0),f(S,null,y(t.items,e=>(d(),f("tr",{key:e.id,class:"d-sm-table-row d-block"},[(d(!0),f(S,null,y(t.fields,o=>(d(),f("td",{key:o.fieldName,class:"d-sm-table-cell d-flex pa-0 h-auto py-3"},[n("div",Y,g(o.fieldText)+": ",1),n("div",Z,g(e[o.fieldName]),1)]))),128)),n("td",ee,[n("div",te,[m(C,{text:"Удалить",location:"bottom","content-class":"tooltip",transition:"slide-x-transition"},{activator:h(({props:o})=>[m(T,k(o,{variant:"flat",icon:"mdi-trash-can",color:"error",class:"mr-2",onClick:c=>r.$emit("openDialog",e,"delete")}),null,16,["onClick"])]),_:2},1024),m(C,{text:"Редактировать",location:"bottom","content-class":"tooltip",transition:"slide-x-reverse-transition"},{activator:h(({props:o})=>[m(T,k(o,{variant:"flat",icon:"mdi-pencil",color:"info",onClick:c=>r.$emit("openDialog",e,"edit")}),null,16,["onClick"])]),_:2},1024)])])]))),128))]),_:1})])]),_:1})):(d(),f("div",ae,g(t.noDataText||"Ничего не найдено"),1))}}),ie=t=>{const l=G(),i=H(),s=v(!1);return{handleLogout:async()=>{try{s.value=!0,await l.logOutUser(),console.log(i),i.push({name:"login-page",query:{isExpiredToken:"true",redirectedFrom:t}})}catch(a){console.log(a)}finally{s.value=!1}},isLogoutLoading:s}};export{ne as _,se as a,oe as b,ie as u};
