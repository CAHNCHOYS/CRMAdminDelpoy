import{d as b,r as F,F as z,B as L,G as q,D as G,H as R,I as M,J as U,K as W,L as H,M as J,N as Q,O as X,Q as D,o as i,y as f,e as r,f as u,c as w,k as h,_ as A,R as Y,E as tt,S as et,T as st,C as B,b as a,m as C,t as $}from"./index-a08b3a6a.js";import"./index-ceebb289.js";const V={data:{type:Object,required:!0},options:{type:Object,default:()=>({})},plugins:{type:Array,default:()=>[]},datasetIdKey:{type:String,default:"label"},updateMode:{type:String,default:void 0}},ot={type:{type:String,required:!0},...V},at=X[0]==="2"?(e,t)=>Object.assign(e,{attrs:t}):(e,t)=>Object.assign(e,t);function k(e){return U(e)?R(e):e}function rt(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;return U(t)?new Proxy(e,{}):e}function nt(e,t){const o=e.options;o&&t&&Object.assign(o,t)}function K(e,t){e.labels=t}function N(e,t,o){const c=[];e.datasets=t.map(s=>{const l=e.datasets.find(n=>n[o]===s[o]);return!l||!s.data||c.includes(l)?{...s}:(c.push(l),Object.assign(l,s),l)})}function lt(e,t){const o={labels:[],datasets:[]};return K(o,e.labels),N(o,e.datasets,t),o}const ct=b({props:ot,setup(e,t){let{expose:o}=t;const c=F(null),s=z(null);o({chart:s});const l=()=>{if(!c.value)return;const{type:p,data:x,options:m,plugins:d,datasetIdKey:y}=e,v=lt(x,y),g=rt(v,x);s.value=new W(c.value,{type:p,data:g,options:{...m},plugins:d})},n=()=>{const p=R(s.value);p&&(p.destroy(),s.value=null)},_=p=>{p.update(e.updateMode)};return L(l),q(n),G([()=>e.options,()=>e.data],(p,x)=>{let[m,d]=p,[y,v]=x;const g=R(s.value);if(!g)return;let O=!1;if(m){const P=k(m),S=k(y);P&&P!==S&&(nt(g,P),O=!0)}if(d){const P=k(d.labels),S=k(v.labels),I=k(d.datasets),Z=k(v.datasets);P!==S&&(K(g.config.data,P),O=!0),I&&I!==Z&&(N(g.config.data,I,e.datasetIdKey),O=!0)}O&&_(g)},{deep:!0}),()=>M("canvas",{ref:c})}});function E(e,t){return W.register(t),b({props:V,setup(o,c){let{expose:s}=c;const l=z(null),n=_=>{l.value=_==null?void 0:_.chart};return s({chart:l}),()=>M(ct,at({ref:n},{type:e,...o}))}})}const j=E("bar",H),T=E("doughnut",J),dt=E("line",Q),ut={key:1,class:"text-h6"},it=b({__name:"ProductsCount",props:{products:null},setup(e){const t=e,o=D(()=>({labels:t.products.map(s=>s.name),datasets:[{label:"Кол-во: ",backgroundColor:["#512DA8","#283593","#0277BD","#558B2F","#78909C","#BDBDBD","#FF9800","#FBC02D","#42A5F5","#8BC34A","#5D4037","#64FFDA","#EC407A","#004D40","#AFB42B","#AD1457","#9E9E9E"],data:t.products.map(s=>s.count),hoverOffset:4}]})),c={responsive:!0,maintainAspectRatio:!1,layout:{padding:0},plugins:{legend:{display:!1},title:{display:!0,color:"black",text:"Количество каждого товара",padding:{bottom:20},font:{size:26,weight:"normal"}}}};return(s,l)=>{const n=h("v-card");return i(),f(n,{"max-width":"100%",elevation:"5",class:"pa-5"},{default:r(()=>[t.products.length?(i(),f(u(T),{key:0,data:u(o),options:c},null,8,["data"])):(i(),w("p",ut,"Недостаточно данных для построения графика"))]),_:1})}}});const pt=A(it,[["__scopeId","data-v-9551457b"]]),_t={key:1,class:"text-h6"},mt=b({__name:"ProductsPrices",props:{products:null},setup(e){const t=e,o=D(()=>({labels:t.products.map(s=>s.name),datasets:[{label:"Цена(руб): ",backgroundColor:["#512DA8","#283593","#0277BD","#558B2F","#78909C","#BDBDBD","#FF9800","#FBC02D","#42A5F5","#8BC34A","#5D4037","#64FFDA","#EC407A","#004D40","#AFB42B","#AD1457","#9E9E9E"],data:t.products.map(s=>s.price),hoverOffset:4}]})),c={responsive:!0,maintainAspectRatio:!1,layout:{padding:0},plugins:{legend:{display:!1},title:{display:!0,color:"black",text:"Цены товаров",padding:{bottom:20},font:{size:26,weight:"normal"}},tooltip:{}}};return(s,l)=>{const n=h("v-card");return i(),f(n,{"max-width":"100%",elevation:"5",class:"pa-5"},{default:r(()=>[t.products.length?(i(),f(u(T),{key:0,data:u(o),options:c},null,8,["data"])):(i(),w("p",_t,"Недостаточно данных для построения графика"))]),_:1})}}});const ft=A(mt,[["__scopeId","data-v-04e52979"]]),gt={key:1,class:"text-h6"},ht=b({__name:"CustomersPremium",props:{customers:null},setup(e){const t=e,o=D(()=>({labels:["Наличие премиума"],datasets:[{label:"Есть премиум",data:[t.customers.filter(s=>s.premium==="Да").length]},{label:"Нету премиума",data:[t.customers.filter(s=>s.premium==="Нет").length]}]})),c={responsive:!0,maintainAspectRatio:!1,layout:{padding:0},elements:{bar:{borderRadius:0,borderWidth:4}},scales:{y:{beginAtZero:!0,suggestedMin:0}},plugins:{legend:{display:!0,position:"bottom",title:{}},title:{display:!0,color:"black",text:"Премиум у клиентов",padding:{bottom:20},font:{size:26,weight:"normal"}}}};return(s,l)=>{const n=h("v-card");return i(),f(n,{"max-width":"100%",class:"pa-5",elevation:"5"},{default:r(()=>[t.customers.length?(i(),f(u(j),{key:0,data:u(o),options:c},null,8,["data"])):(i(),w("p",gt,"Недостаточно данных для построения графика"))]),_:1})}}});const yt=A(ht,[["__scopeId","data-v-377b486c"]]),bt={key:1,class:"text-h6"},vt=b({__name:"CategoryProductsCount",props:{categories:null,products:null},setup(e){const t=e,o=D(()=>({labels:["Количество товара по категориям"],datasets:t.categories.map(s=>({label:s.name,data:[t.products.filter(l=>l.category===s.name).length]}))})),c={responsive:!0,maintainAspectRatio:!1,layout:{padding:0},elements:{bar:{borderRadius:0,borderWidth:4}},scales:{x:{grid:{display:!1}},y:{grid:{display:!1}}},plugins:{legend:{display:!0,position:"bottom"},title:{display:!0,color:"black",text:"Количество товаров по категориям",padding:{bottom:20},font:{size:26,weight:"normal"}}}};return(s,l)=>{const n=h("v-card");return i(),f(n,{"max-width":"100%",class:"pa-5",elevation:"5"},{default:r(()=>[t.products.length?(i(),f(u(j),{key:0,data:u(o),options:c},null,8,["data"])):(i(),w("p",bt,"Недостаточно данных для построения графика"))]),_:1})}}});const xt=A(vt,[["__scopeId","data-v-07495283"]]),Ct={key:1,class:"text-h6"},Dt=b({__name:"OrdersByDate",props:{orders:null},setup(e){const t=e;function o(n){return n.split("-").reverse().join("-")}const c=D(()=>{const n=[],_=[];for(const p of t.orders)if(!n.includes(p.date)){const x=t.orders.filter(m=>m.date===p.date);n.push(p.date),_.push(x.reduce((m,d)=>m+d.productCount,0))}return _}),s=D(()=>({labels:[...new Set(t.orders.sort((n,_)=>Date.parse(o(n.date))-Date.parse(o(_.date))).map(n=>n.date))],datasets:[{label:"Кол-во товаров",data:c.value,borderColor:"#3F51B5",fill:!1,borderWidth:4}]})),l={responsive:!0,maintainAspectRatio:!1,layout:{padding:0},scales:{y:{beginAtZero:!1,suggestedMin:0,grid:{display:!1}},x:{grid:{display:!1}}},plugins:{legend:{display:!1},title:{display:!0,color:"black",text:"Кол-во товаров в заказах",padding:{bottom:20},font:{size:26,weight:"normal"}}}};return(n,_)=>{const p=h("v-card");return i(),f(p,{width:"100%",color:"white",class:"pa-5",elevation:"5"},{default:r(()=>[t.orders.length?(i(),f(u(dt),{key:0,data:u(s),options:l},null,8,["data"])):(i(),w("p",Ct,"Недостаточно данных для построения графика"))]),_:1})}}});const wt=A(Dt,[["__scopeId","data-v-e2cbfbac"]]),Pt={key:1,class:"text-h6"},Bt=b({__name:"ProductsInOrders",props:{products:null,orders:null},setup(e){const t=e,o=D(()=>({labels:["Товары"],datasets:t.products.map(s=>({label:s.name,data:[t.orders.filter(l=>l.productId===s.id).length]}))})),c={responsive:!0,maintainAspectRatio:!1,scales:{y:{beginAtZero:!0,grid:{display:!1}},x:{grid:{display:!1}}},layout:{padding:0},elements:{bar:{borderWidth:4,borderRadius:0}},plugins:{title:{display:!0,text:"Сколько раз был заказан какой товар",padding:{bottom:20},font:{size:20,weight:"bold"}},legend:{display:!1}}};return(s,l)=>{const n=h("v-card");return i(),f(n,{color:"white",class:"pa-5",elevation:"5"},{default:r(()=>[t.orders.length?(i(),f(u(j),{key:0,data:u(o),options:c},null,8,["data"])):(i(),w("p",Pt,"Недостаточно данных для построения графика"))]),_:1})}}});const kt=A(Bt,[["__scopeId","data-v-bd750fb1"]]),At=C("h2",{class:"title text-sm-h2 text-h3 mb-6"},"Статистика",-1),Ot=C("p",{class:"text-sm-h5 text-h6"},"Всего товаров",-1),Ft={class:"text-h2"},St=C("p",{class:"text-sm-h5 text-h6"},"Всего Клиентов",-1),It={class:"text-h2"},$t=C("p",{class:"text-sm-h5 text-h6"},"Всего Заказов",-1),Rt={class:"text-h2"},zt=b({__name:"StatiscticView",setup(e){const{smAndDown:t}=Y(),o=tt(),c=et(),s=st(),l=F({count:0}),n=F({count:0}),_=F({count:0});return L(async()=>{o.productsCategories.length||await o.getAllProductsCategories(),B.from(".title",{x:"-300",opacity:0,ease:"linear",duration:.5}),B.from(".stats-header > *",{x:"-100%",stagger:.25,duration:.25,opacity:0,ease:"power2.out"}),B.from(".charts-row > *",{scale:0,stagger:.35,duration:.35,opacity:0,ease:"power3.out",delay:.85,scrollTrigger:{trigger:".charts-row",start:"top 80%",end:"+=1000"}}),B.to(l.value,{count:o.userProducts.length,duration:2,delay:.25}),B.to(n.value,{count:c.customers.length,duration:2,delay:.5}),B.to(_.value,{count:s.orders.length,duration:2,delay:.75})}),(p,x)=>{const m=h("v-btn"),d=h("v-col"),y=h("v-row"),v=h("v-card-text"),g=h("v-card");return i(),w("div",null,[At,a(y,{class:"stats-header"},{default:r(()=>[a(d,{sm:"4",cols:"12",class:"left-header-col"},{default:r(()=>[a(g,{color:"green",height:"100%",elevation:"0"},{default:r(()=>[a(v,null,{default:r(()=>[a(y,{align:"center","no-gutters":u(t)},{default:r(()=>[a(d,{md:"auto",cols:"12",class:"d-md-block d-flex justify-center mb-md-0 mb-1"},{default:r(()=>[a(m,{icon:"mdi-laptop",color:"blue-grey",class:"text-white"})]),_:1}),a(d,{cols:"auto",class:"flex-grow-1 text-md-left text-center"},{default:r(()=>[Ot,C("p",Ft,$(l.value.count.toFixed(0)),1)]),_:1})]),_:1},8,["no-gutters"])]),_:1})]),_:1})]),_:1}),a(d,{sm:"4",cols:"6",class:"right-header-col"},{default:r(()=>[a(g,{color:"deep-orange-lighten-2",height:"100%",elevation:"0"},{default:r(()=>[a(v,null,{default:r(()=>[a(y,{align:"center","no-gutters":u(t)},{default:r(()=>[a(d,{md:"auto",cols:"12",class:"d-md-block d-flex justify-center mb-md-0 mb-1"},{default:r(()=>[a(m,{icon:"mdi-account",color:"cyan",class:"text-white"})]),_:1}),a(d,{cols:"auto",class:"flex-grow-1 text-white text-md-left text-center"},{default:r(()=>[St,C("p",It,$(n.value.count.toFixed(0)),1)]),_:1})]),_:1},8,["no-gutters"])]),_:1})]),_:1})]),_:1}),a(d,{sm:"4",cols:"6",class:"right-header-col"},{default:r(()=>[a(g,{color:"light-blue",height:"100%",elevation:"0"},{default:r(()=>[a(v,null,{default:r(()=>[a(y,{align:"center","no-gutters":u(t)},{default:r(()=>[a(d,{md:"auto",cols:"12",class:"d-md-block d-flex justify-center mb-md-0 mb-1"},{default:r(()=>[a(m,{icon:"mdi-wallet",color:"pink",class:"text-white"})]),_:1}),a(d,{cols:"auto",class:"flex-grow-1 text-white text-md-left text-center"},{default:r(()=>[$t,C("p",Rt,$(_.value.count.toFixed(0)),1)]),_:1})]),_:1},8,["no-gutters"])]),_:1})]),_:1})]),_:1})]),_:1}),a(y,{align:"stretch",class:"charts-row"},{default:r(()=>[a(d,{md:"4",sm:"6",cols:"12"},{default:r(()=>[a(pt,{products:u(o).userProducts},null,8,["products"])]),_:1}),a(d,{md:"4",sm:"6",cols:"12"},{default:r(()=>[a(ft,{products:u(o).userProducts},null,8,["products"])]),_:1}),a(d,{md:"4",sm:"6",cols:"12"},{default:r(()=>[a(yt,{customers:u(c).customers},null,8,["customers"])]),_:1}),a(d,{md:"4",sm:"6",cols:"12"},{default:r(()=>[a(xt,{products:u(o).userProducts,categories:u(o).productsCategories},null,8,["products","categories"])]),_:1}),a(d,{md:"8",cols:"12"},{default:r(()=>[a(wt,{orders:u(s).orders},null,8,["orders"])]),_:1}),a(d,{cols:"12"},{default:r(()=>[a(kt,{products:u(o).userProducts,orders:u(s).orders},null,8,["products","orders"])]),_:1})]),_:1})])}}});export{zt as default};
