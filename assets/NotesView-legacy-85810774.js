System.register(["./index-legacy-bdf57a8f.js","./alert-legacy-4db1546e.js"],(function(e,t){"use strict";var a,l,o,r,n,s,i,d,u,c,g,m,p,v,y,h,f,w,_,x,b,N,k,V,T,C,D,M,U,F,A,S,$,z,E,H,I,L,j,q,B,O,P,Z,G,J=document.createElement("style");return J.textContent=".note[data-v-44834e74]{cursor:move}.dragging{opacity:.5!important}.white-input .v-messages__message{color:#fff!important}\n",document.head.appendChild(J),{setters:[e=>{a=e.d,l=e.r,o=e.o,r=e.c,n=e.q,s=e.al,i=e.am,d=e.t,u=e.b,c=e.C,g=e.e,m=e.E,p=e.an,v=e.ao,y=e._,h=e.a,f=e.u,w=e.P,_=e.S,x=e.i,b=e.h,N=e.g,k=e.U,V=e.O,T=e.z,C=e.m,D=e.M,M=e.Z,U=e.a0,F=e.ap,A=e.aq,S=e.B,$=e.x,z=e.y,E=e.p,H=e.ar,I=e.n,L=e.s,j=e.a3,q=e.v,B=e.F,O=e.f,P=e.a2,Z=e.T},e=>{G=e.u}],execute:function(){const t={class:"d-flex align-center"},J={class:"flex-grow-1"},K=y(a({__name:"Note",props:{note:null},emits:["deleteNote","dragstart","dragend","updateNote"],setup(e,{emit:a}){const y=e,h=l(!1),f=()=>{a("updateNote",y.note),h.value=!1};return(a,l)=>(o(),r("div",{class:"note py-3 px-4 bg-white mb-3",onDragstart:l[3]||(l[3]=t=>a.$emit("dragstart",t,e.note.id)),onDragend:l[4]||(l[4]=e=>a.$emit("dragend",e))},[n("div",t,[s(n("div",{class:"text-h6 flex-grow-1 pr-1"},d(e.note.title),513),[[i,!h.value]]),s(n("div",J,[u(c,{modelValue:e.note.title,"onUpdate:modelValue":l[0]||(l[0]=t=>e.note.title=t),density:"comfortable",variant:"underlined",clearable:!1,"bg-color":"white"},null,8,["modelValue"])],512),[[i,h.value]]),n("div",null,[u(v,null,{default:g((({props:t,isHovering:o})=>[u(m,p({icon:"mdi-trash-can",size:"large",color:o?"red-darken-3":"grey",onClick:l[1]||(l[1]=t=>a.$emit("deleteNote",e.note.id))},t),null,16,["color"])])),_:1}),u(v,null,{default:g((({props:e,isHovering:t})=>[s(u(m,p({onClick:l[2]||(l[2]=e=>h.value=!h.value),icon:"mdi-pencil",size:"large",color:t?"blue":"grey"},e),null,16,["color"]),[[i,!h.value]])])),_:1}),u(v,null,{default:g((({props:e,isHovering:t})=>[s(u(m,p({onClick:f,style:{cursor:"pointer"},icon:"mdi-content-save-all",size:"large",color:t?"green":"grey"},e),null,16,["color"]),[[i,h.value]])])),_:1})])])],32))}}),[["__scopeId","data-v-44834e74"]]),Q=new class{async getNotes(e){return h.get(`/Notes/${e}`)}async updateNote(e){return await h.patch("/Notes",e)}async deleteNote(e){return await h.delete(`/Notes/${e}`)}async addNote(e){return await h.post("/Notes",e)}},R={class:"text-h6"},W=n("div",{class:"text-h2 mb-8 title"},"Ваши заметки",-1),X={key:0,class:""},Y=n("p",{class:"mb-3 text-h6"},"Загрузка заметок ...",-1),ee={key:0,color:"transparent","max-height":700,style:{overflow:"auto","max-height":"700px"}},te=["onClick"],ae=n("p",{class:"mb-2"},"Загрузка...",-1);e("default",a({__name:"NotesView",setup(e){const t=l([{title:"В процессе",isFormActive:!1,addText:""},{title:"Сделать потом",isFormActive:!1,addText:""},{title:"Сделано",isFormActive:!1,addText:""}]),a=(e,t)=>{e.target.classList.add("dragging"),e.dataTransfer.setData("id",t.toString())},p=e=>{e.target.classList.remove("dragging")},v=G(),y=f(),h=l([]),J=l(!1),le=l(!1),oe=l(null),re=w((()=>function(e){return h.value.filter((t=>t.type===e))}));_((async()=>{le.value=!0;try{const{data:e}=await Q.getNotes(y.currentUser.id);h.value=e.notes}catch(e){x(e)?oe.value=b(e):oe.value="Ошибка при загрузке заметок!"}le.value=!1}));const ne=async e=>{J.value=!0;try{await Q.updateNote(e)}catch(t){x(t)?v.showMessage("error",b(t)):v.showMessage("error","Ошибка при добавлении заметки!")}J.value=!1},se=async e=>{J.value=!0;try{await Q.deleteNote(e),h.value=h.value.filter((t=>t.id!=e))}catch(t){x(t)?v.showMessage("error",b(t)):v.showMessage("error","Ошибка при добавлении заметки!")}J.value=!1},ie=(e,t)=>{Z.from(e,{opacity:0,scale:0,ease:"sine.out",duration:.6,onComplete:t})},de=(e,t)=>{Z.to(e,{duration:.6,ease:"sine.out",opacity:0,scale:0,onComplete:t})};return(e,l)=>(o(),r("div",null,[u(k,{modelValue:N(v).isMessageShown,"onUpdate:modelValue":l[0]||(l[0]=e=>N(v).isMessageShown=e),color:N(v).messageType},{default:g((()=>[n("p",R,d(N(v).messageText),1)])),_:1},8,["modelValue","color"]),W,le.value?(o(),r("div",X,[Y,u(U,{color:"green",height:"4",indeterminate:""})])):(o(),V(T,{key:1,class:"row"},{default:g((()=>[(o(!0),r(F,null,A(t.value,(e=>(o(),V(S,{key:e.title,onDragover:l[1]||(l[1]=$((()=>{}),["prevent"])),onDrop:t=>(async(e,t)=>{const a=e.dataTransfer?.getData("id");if(a){const e=h.value.find((e=>e.id===+a));e.type=t,await ne(e)}})(t,e.title)},{default:g((()=>[u(O,{color:"blue-grey-darken-1 pa-4"},{default:g((()=>[u(z,{class:"text-h4 text-white mb-5 pa-0"},{default:g((()=>[E(d(e.title),1)])),_:2},1024),N(re)(e.title).length?(o(),r("div",ee,[u(H,{onEnter:ie,onLeave:de,css:!1,appear:""},{default:g((()=>[(o(!0),r(F,null,A(N(re)(e.title),(e=>(o(),V(K,{key:e.id,note:e,onDeleteNote:se,onUpdateNote:ne,draggable:"true",onDragstart:a,onDragend:p},null,8,["note"])))),128))])),_:2},1024)])):(o(),V(C,{key:1,color:"white",class:"mb-2","border-color":"white"},{default:g((()=>[u(I,null,{default:g((()=>[E("Пока нет заметок, добавьте хоть одну !")])),_:1})])),_:1})),u(L,{class:"d-flex flex-column pa-0 align-stretch",style:{"min-height":"auto"}},{default:g((()=>[n("div",{onClick:t=>e.isFormActive=!e.isFormActive,style:{cursor:"pointer"}},[u(m,{icon:e.isFormActive?"mdi-minus":"mdi-plus"},null,8,["icon"]),E(" Добавить заметку ")],8,te),u(j,null,{default:g((()=>[s(u(q,{onSubmit:$((t=>{(async(e,t)=>{if(!(e.length<1)){J.value=!0;try{const{data:a}=await Q.addNote({title:e,type:t,userId:y.currentUser.id});h.value.push({id:a.noteId,title:e,type:t})}catch(a){x(a)?v.showMessage("error",b(a)):v.showMessage("error","Ошибка при добавлении заметки!")}J.value=!1}})(e.addText,e.title),e.addText=""}),["prevent"])},{default:g((()=>[u(c,{"bg-color":"white",color:"black",placeholder:"Задача...",modelValue:e.addText,"onUpdate:modelValue":t=>e.addText=t,class:"my-2 white-input",rules:[e=>!!e||"Поле обязательное для ввода"]},null,8,["modelValue","onUpdate:modelValue","rules"]),u(B,{type:"submit",variant:"flat",color:"green"},{default:g((()=>[E("Добавить")])),_:1})])),_:2},1032,["onSubmit"]),[[i,e.isFormActive]])])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1032,["onDrop"])))),128))])),_:1})),!le.value&&oe.value?(o(),V(C,{key:2,type:"error",border:"end",variant:"tonal"},{default:g((()=>[u(I,{class:"mb-2"},{default:g((()=>[E(" Ошибка при загрузке товаров ")])),_:1}),n("p",null,d(oe.value),1)])),_:1})):D("",!0),u(M,{modelValue:J.value,"onUpdate:modelValue":l[2]||(l[2]=e=>J.value=e),scrim:!1,persistent:"",width:"auto"},{default:g((()=>[u(O,{color:"indigo-darken-4"},{default:g((()=>[u(P,null,{default:g((()=>[ae,u(U,{indeterminate:"",color:"white",class:"mb-0"})])),_:1})])),_:1})])),_:1},8,["modelValue"])]))}}))}}}));
