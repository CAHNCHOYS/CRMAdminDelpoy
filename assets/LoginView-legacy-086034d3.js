System.register(["./index-legacy-2e63bdda.js","./useFormSchemas-legacy-7f6262d4.js"],(function(e,a){"use strict";var t,l,s,r,o,i,d,n,c,u,m,g,p,f,h,b,x,v,w,y,_,k,S,V,M,z,T,q,F,U,j,C,E,A,B,D,I,L,O,$,G,H=document.createElement("style");return H.textContent='.fullscreen[data-v-d0ebef7a]{position:relative;padding:20px 15px}.form-card[data-v-d0ebef7a]{position:relative;z-index:4}.bg-image[data-v-d0ebef7a]{position:absolute;width:100%;height:100%;top:0;left:0;z-index:2}.bg-image[data-v-d0ebef7a]:before{content:"";position:absolute;z-index:3;width:100%;height:100%;top:0;left:0;background-color:rgba(196,196,196,.3)}.form-title[data-v-d0ebef7a]{background-color:#c6d9ee;font-weight:600;color:#0f1e54}.alert[data-v-d0ebef7a]{position:fixed;z-index:1000;left:10px;top:15px;width:calc(100% - 20px)!important;height:auto}.icon[data-v-d0ebef7a]{opacity:1!important;color:#0f1e54}\n',document.head.appendChild(H),{setters:[e=>{t=e.d,l=e.r,s=e.u,r=e.a,o=e.A,i=e.b,d=e.i,n=e.h,c=e.w,u=e.c,m=e.e,g=e.f,p=e.V,f=e.g,h=e.j,b=e.k,x=e.l,v=e.m,w=e.o,y=e.n,_=e.p,k=e.q,S=e.t,V=e.s,M=e.v,z=e.x,T=e.y,q=e.z,F=e.B,U=e.C,j=e.D,C=e.E,E=e.F,A=e.G,B=e.H,D=e.I,I=e.J,L=e._},e=>{O=e.u,$=e.a,G=e.b}],execute:function(){const H=""+new URL("bg-ffc91902.png",a.meta.url).href,J=e=>(D("data-v-d0ebef7a"),e=e(),I(),e),P={class:"fullscreen h-100 d-flex justify-center align-center"},R={class:"text-white text-h6"},K=J((()=>V("span",{class:"text-white text-h6 font-weight-medium"},"Войти",-1))),N={class:"mt-2"},Q=J((()=>V("span",{class:"text-decoration-underline text-green"}," Зарегистрироваться ",-1)));e("default",L(t({__name:"LoginView",setup(e){const{loginSchema:a}=O(),{handleSubmit:t,isSubmitting:D,resetForm:I}=$({validationSchema:a}),{value:L,errorMessage:J}=G("email"),{value:W,errorMessage:X}=G("password"),Y=l(!1),Z=s(),ee=r(),ae=x(),te=v(),le=t((async e=>{try{const{data:a}=await o.login(e);Z.setToken(a.accessToken),Z.setUser(a.user),await Z.fetchData(),i.defaults.headers.common.Authorization=`Bearer ${a.accessToken}`,ee.showMessage("success","Авторизация успешна, вскоре вы будете переведены на сайт"),setTimeout((()=>{ae.query.redirectedFrom?te.push({name:ae.query.redirectedFrom}):te.push("/")}),3500)}catch(a){console.log(a),d(a)?ee.showMessage("error",n(a)):ee.showMessage("error","Ошибка при авторизации, попробуйте позже")}finally{I()}}));return c((()=>{ae.query.redirectedFrom&&!ae.query.isExpiredToken&&ee.showMessage("error",`Для доступа к странице ${ae.query.redirectedFrom} необходимо авторизироваться`),ae.query.isExpiredToken&&(ee.showMessage("error","Сеанс авторизации истек, войдите в аккаунт снова!"),Z.logOutUser())})),(e,a)=>{const t=B("router-link");return w(),u("div",P,[m(p,null,{default:g((()=>[m(y,{class:"alert",type:h(ee).messageType,"max-width":400,modelValue:h(ee).isMessageShown,"onUpdate:modelValue":a[0]||(a[0]=e=>h(ee).isMessageShown=e)},{default:g((()=>[m(_,{class:"text-h4 mb-2"},{default:g((()=>[k(S("error"===h(ee).messageType?"Ошибка":"Уведомление"),1)])),_:1}),V("div",R,S(h(ee).messageText),1)])),_:1},8,["type","modelValue"])])),_:1}),m(f,{class:"form-card flex-grow-1 pb-8 rounded-lg","max-width":486,elevation:0},{default:g((()=>[m(M,{class:"form-title text-center text-h4 pa-0 py-4"},{default:g((()=>[k("Авторизация")])),_:1}),m(z,{class:"pt-4 pb-1 px-lg-10 px-md-8 px-4"},{default:g((()=>[m(T,{onSubmit:q(h(le),["prevent"]),class:"w-100"},{default:g((()=>[m(M,{class:"text-indigo-darken-2 text-center mb-2"},{default:g((()=>[k(" Введите ваши данные")])),_:1}),m(F,null,{default:g((()=>[m(U,{cols:"12"},{default:g((()=>[m(j,{modelValue:h(L),"onUpdate:modelValue":a[1]||(a[1]=e=>C(L)?L.value=e:null),"error-messages":h(J),"bg-color":"rgba(229, 229, 229, 0.25)",placeholder:"Ваша почта",hint:"Ваша почта при регистрации",clearable:""},{"prepend-inner":g((()=>[m(E,{icon:"mdi-email",class:"icon mr-lg-3 mr-1",size:"large"})])),_:1},8,["modelValue","error-messages","bg-color"])])),_:1}),m(U,{cols:"12"},{default:g((()=>[m(j,{modelValue:h(W),"onUpdate:modelValue":a[3]||(a[3]=e=>C(W)?W.value=e:null),"error-messages":h(X),"bg-color":"rgba(229, 229, 229, 0.25)",placeholder:"Ваш пароль",hint:"Ваш пароль при регистрации",type:Y.value?"text":"password",clearable:""},{"prepend-inner":g((()=>[m(E,{icon:"mdi-lock",class:"icon mr-lg-3 mr-1",size:"large"})])),"append-inner":g((()=>[m(E,{onClick:a[2]||(a[2]=e=>Y.value=!Y.value),class:"text-dark-blue",icon:Y.value?"mdi-eye":"mdi-eye-off",size:"large"},null,8,["icon"])])),_:1},8,["modelValue","error-messages","bg-color","type"])])),_:1}),m(U,null,{default:g((()=>[m(A,{type:"submit",loading:h(D),disabled:h(D)||h(ee).isMessageShown,block:"",color:"dark-blue",variant:"flat"},{default:g((()=>[K])),_:1},8,["loading","disabled"]),V("p",N,[m(t,{to:{name:"register-page"},class:"text-black text-h6"},{default:g((()=>[k("Нет аккаунта? "),Q])),_:1})])])),_:1})])),_:1})])),_:1},8,["onSubmit"])])),_:1})])),_:1}),m(b,{class:"bg-image",cover:"",src:h(H),alt:"OfficePic"},null,8,["src"])])}}}),[["__scopeId","data-v-d0ebef7a"]]))}}}));
